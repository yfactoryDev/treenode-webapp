"use strict";(function(e){var t=function(e,t){var i=[],r=31;e=parseInt(e),2===(t=parseInt(t))?r=function(e){return e%4==0&&e%100!=0||e%400==0}(e)?29:28:[4,6,9,11].indexOf(t)>-1&&(r=30);for(var n=0;n<r;n++)i.push(n+1+"\u65e5");return i},i=function(e){this.pickerOpts=e,this.prefix="_picker-"+(new Date).getTime(),this.itemHeight=30,this.pos={startY:0,moveY:0,endY:0,curY:0,itemStartY:0},this.checkDate(),this.createPickerDom(),this.container=document.querySelector("."+this.prefix),this.mask=this.container.querySelector("._picker-mask"),this.cols=this.container.querySelectorAll("._picker-col"),this.col_list=this.container.querySelectorAll("._picker-data-list"),this.btnCancel=this.container.querySelector("._picker-btn-cancel"),this.btnConfirm=this.container.querySelector("._picker-btn-confirm"),this.pickerOpts.selector&&(this.selector=document.getElementById(this.pickerOpts.selector)),this.bind()};i.prototype={show:function(){this.container.className="_picker-container "+this.prefix},bind:function(){var e=this,t=function(){"function"==typeof e.pickerOpts.onCancel&&e.pickerOpts.onCancel(),e.container.className="_picker-container hide"};this.mask.addEventListener("touchend",t,!1),this.btnCancel.addEventListener("touchend",t,!1),this.btnConfirm.addEventListener("touchend",function(){if("function"==typeof e.pickerOpts.onConfirm){for(var t=[],i=0;i<e.pickerOpts.cols.length;i++){var r=void 0!==e.pickerOpts.cols[i].curVal?e.pickerOpts.cols[i].curVal:e.pickerOpts.cols[i].values[0];t.push("date"===e.pickerOpts.type?parseInt(r.substr(0,r.length-1)):r)}e.pickerOpts.onConfirm(t)}e.container.className="_picker-container hide"},!1),this.selector&&this.selector.addEventListener("touchend",function(){e.show()},!1);for(var i=0;i<this.cols.length;i++)this.cols[i].addEventListener("touchstart",e.touchEventCallBack(i,"touchstart",e.pos),!1),this.cols[i].addEventListener("touchmove",e.touchEventCallBack(i,"touchmove",e.pos),!1),this.cols[i].addEventListener("touchend",e.touchEventCallBack(i,"touchend",e.pos),!1)},touchEventCallBack:function(e,i,r){var n=this;return function(s){switch(s.preventDefault(),i){case"touchstart":r.startY=s.touches[0].clientY,r.curY=r.itemStartY=(3-n.pickerOpts.cols[e].curIndex)*n.itemHeight,n.col_list[e].classList.remove("animate");break;case"touchmove":r.moveY=s.changedTouches[0].clientY,r.curY=r.itemStartY+(r.moveY-r.startY),n.col_list[e].setAttribute("style","-webkit-transform:translate3d(0, "+r.curY+"px, 0);transform:translate3d(0, "+r.curY+"px, 0)");break;case"touchend":r.endY=s.changedTouches[0].clientY;var c=Math.round((r.startY-r.endY)/n.itemHeight)+n.pickerOpts.cols[e].curIndex,o=n.pickerOpts.cols[e].values.length;if(c<0?c=0:c>=o&&(c=o-1),n.pickerOpts.cols[e].curIndex=c,n.pickerOpts.cols[e].curVal=n.pickerOpts.cols[e].values[c],n.col_list[e].classList.add("animate"),n.col_list[e].setAttribute("style","-webkit-transform:translate3d(0, "+(3-c)*n.itemHeight+"px, 0);transform:translate3d(0, "+(3-c)*n.itemHeight+"px, 0);"),"date"===n.pickerOpts.type&&(1===e||0===e&&"2\u6708"===n.pickerOpts.cols[1].curVal)){var a=n.pickerOpts.cols[0].curVal,l=n.pickerOpts.cols[1].curVal;n.updateCol(2,{values:t(a.substr(0,a.length-1),l.substr(0,l.length-1))})}if("function"==typeof n.pickerOpts.onSelected){var p=n.pickerOpts.cols[e].curVal;n.pickerOpts.onSelected(e,n.pickerOpts.cols[e].curIndex,"date"===n.pickerOpts.type?parseInt(p.substr(0,p.length-1)):p)}}}},checkDate:function(){var e=this.pickerOpts;if(e.type&&"date"===e.type){for(var i=e.start||1990,r=e.end||new Date.getFullYear,n=[],s=[],c=e.curYear||i,o=e.curMonth||1,a=i;a<=r;a++)n.push(a+"\u5e74");for(var l=0;l<12;l++)s.push(l+1+"\u6708");this.pickerOpts.cols=[{values:n,curVal:c+"\u5e74"},{values:s,curVal:o+"\u6708"},{values:t(c,o),curVal:"1\u65e5"}]}},createPickerDom:function(){for(var e=this.pickerOpts,t="",i=0;i<e.cols.length;i++)this.initCol(e.cols[i]),t+='<div class="_picker-col">'+this.setOptions(e.cols[i])+"</div>";var r='<div class="_picker-container hide '+this.prefix+'"><div class="_picker-mask"></div><div class="_picker-wrapper"><div class="_picker-head"><h3 class="_picker-title">'+(e.title||"")+'</h3><a class="_picker-btn-cancel" href="javascript:;">\ucde8\uc18c</a><a class="_picker-btn-confirm" href="javascript:;">\ud655\uc778</a></div><div class="_picker-content">'+t+"</div></div></div>",n=document.createElement("div");n.innerHTML=r,document.body.appendChild(n)},setOptions:function(e){this.initCol(e);for(var t='<ul class="_picker-data-list" style="-webkit-transform:translate3d(0, '+(3-e.curIndex)*this.itemHeight+"px, 0);transform:translate3d(0, "+(3-e.curIndex)*this.itemHeight+'px, 0)">',i=0;i<e.values.length;i++)t+="<li>"+e.values[i]+"</li>";return t+"</ul>"},initCol:function(e){if(e.values.length)if(e.curVal){var t=e.values.indexOf(e.curVal);-1===t?(e.curVal=e.values[0],e.curIndex=0):e.curIndex=t}else e.curVal=e.values[0],e.curIndex=0},updateCol:function(e,t){this.cols[e].innerHTML=this.setOptions(t),this.pickerOpts.cols[e]=t,this.col_list=document.querySelectorAll("."+this.prefix+" ._picker-data-list")}};var r=document.createElement("style");r.innerText="._picker-container{position:fixed;z-index:9999;top:0;left:0;bottom:0;right:0;font-size:0;font-family:PingFangSC-Light,'Helvetica Neue',sans-serif;margin:0;padding:0;-webkit-user-select:none;user-select:none;visibility:visible}._picker-container a{outline:0;-webkit-tap-highlight-color:rgba(0,0,0,0)}._picker-mask{position:absolute;top:0;left:0;bottom:0;right:0;background-color:rgba(0,0,0,0.5);-webkit-transition:all .3s ease 0s;transition:all .3s ease 0s;opacity:1}._picker-wrapper{position:absolute;bottom:0;width:100%;-webkit-transition:all .3s ease;transition:all .3s ease}._picker-head{position:relative;height:50px;line-height:50px;background-color:#f4f4f4;overflow:hidden;text-align:center}._picker-title{font-size:16px;font-weight:bold;width:68%;margin:0 auto;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}._picker-btn-cancel,._picker-btn-confirm{font-size:16px;color:#888;text-decoration:none;position:absolute;left:0;top:0;bottom:0;width:16%}._picker-btn-confirm{color:#0c86ff;left:initial;right:0}._picker-content{display:-webkit-box;display:-webkit-flex;display:flex;height:220px;background-color:#fff;font-size:18px;text-align:center;overflow:hidden;position:relative}._picker-content:before{content:'';position:absolute;left:0;right:0;bottom:120px;top:0;pointer-events:none;background:linear-gradient(180deg,hsla(0,0%,100%,.9),hsla(0,0%,100%,.6));border-bottom:solid 1px #ddd;z-index:2}._picker-content:after{content:'';position:absolute;left:0;right:0;bottom:0;top:130px;pointer-events:none;background:linear-gradient(0deg,hsla(0,0%,100%,.9),hsla(0,0%,100%,.6));border-top:solid 1px #ddd;z-index:2}._picker-col{-webkit-box-flex:1;-webkit-flex:1;flex:1;position:relative}._picker-col-inner{position:absolute;width:100%;height:100%;left:0;right:0;top:0;bottom:0}._picker-data-list{padding:0;margin:10px 0}._picker-data-list.animate{-webkit-transition:transform .3s ease 0s;transition:transform .3s ease 0s}._picker-data-list>li{list-style:none;height:30px;line-height:30px}._picker-container.hide{pointer-events:none;visibility:hidden}._picker-container.hide ._picker-mask{opacity:0}._picker-container.hide ._picker-wrapper{bottom:-100%}",document.body.appendChild(r),e.PickerView=i})(window),"function"==typeof define&&define.amd?define("pickerView",[],function(){return PickerView}):"undefined"!=typeof module&&module.exports&&(module.exports=PickerView);